-- 04_business_analysis.sql
-- Purpose: Generate business insights

-- Top 10 best value products by discount
SELECT DISTINCT name, mrp, discount_percent
FROM Zepto
ORDER BY discount_percent DESC
LIMIT 10;

-- High-priced products that are out of stock
SELECT DISTINCT name, mrp
FROM Zepto
WHERE out_of_stock = TRUE
  AND mrp > 300
ORDER BY mrp DESC;

-- Category-wise revenue
SELECT category,
       SUM(discounted_selling_price * availabale_quantity) AS total_revenue
FROM Zepto
GROUP BY category
ORDER BY total_revenue DESC;
